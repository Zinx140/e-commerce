let barang = [
    {
        "nama" : "OPPO Find X8 Pink",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "13.249.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "OPPO Find X8 adalah smartphone flagship terbaru dari OPPO yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/oppofindx8shellpink.jpg",
        "category" : "all phone top recomended special",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "OPPO Find X8 Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "13.249.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "OPPO Find X8 adalah smartphone flagship terbaru dari OPPO yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/oppofindx8spaceblack.jpg",
        "category" : "all hot phone top special discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "OPPO Find X8 Grey",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "13.249.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "OPPO Find X8 adalah smartphone flagship terbaru dari OPPO yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/oppofindx8grey.jpg",
        "category" : "all phone top recomended discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Samsung A06 Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.349.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Samsung Galaxy A06 adalah smartphone flagship terbaru dari Samsung yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/samsungblueblack.jpg",
        "category" : "all hot phone recomended special discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Exynos 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Samsung A06 Light",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.349.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Samsung Galaxy A06 adalah smartphone flagship terbaru dari Samsung yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/samsunga06light.webp",
        "category" : "all phone top special discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Redmi 14c Blue",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.439.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Redmi 14c adalah smartphone flagship terbaru dari Redmi yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/redmi14cblue.webp",
        "category" : "all hot top recomended discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Redmi 14c Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.439.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Redmi 14c adalah smartphone flagship terbaru dari Redmi yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/redmi14cblack.webp",
        "category" : "all phone top special discount recomended",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Infinix HOT 50 Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "2.350.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Infinix HOt 50 adalah smartphone flagship terbaru dari Infinix yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/infinix50black.jpg",
        "category" : "all phone top recomended special",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Infinix HOT 50 Grey",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "2.350.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Infinix HOt 50 adalah smartphone flagship terbaru dari Infinix yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/infinixhot50grey.png",
        "category" : "all phone top discount special",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "POCO C75 Green",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.599.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "POCO C75 adalah smartphone flagship terbaru dari Redmi yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/pococ75green.jpg",
        "category" : "all hot phone recomended special",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "POCO C75 Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "1.599.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "POCO C75 adalah smartphone flagship terbaru dari Redmi yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/pococ75black.jpg",
        "category" : "all phone top recomended discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    }, 
    {
        "nama" : "Vivo V40 Black",
        "gimmick" : "13.000.000,00 IDR",
        "price" : "3.140.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Vivo adalah smartphone flagship terbaru dari Vivo yang menawarkan berbagai fitur canggih dan spesifikasi unggulan.",
        "gambar" : "productIMG/vivov40black.webp",
        "category" : "all hot phone recomended discount",
        "spesifikasi" :  [
            "ukuran: 6.59 inch",
            "Prosesor: Dimensity 9400",
            "OS Version: Android 15",
            "RAM: 12GB",
            "Penyimpanan internal: 256GB",
            "Resolusi Kamera: 50MP",
            "Baterai: 5630mAH",
            "NFC: tersedia"
        ]
    },
    {
        "nama" : "Hikaru Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/hikaruglass.jpg",
        "category" : "all hot accessories special discount",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu"
        ]
    },
    {
        "nama" : "Octagood Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/octagoodglass.jpg",
        "category" : "all top accessories special recomended",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu"
        ]
    },
    {
        "nama" : "Anti Spy Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/antivioletspy.webp",
        "category" : "all hot accessories special recomended",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "Anti Ultraviolet Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/5dblueray.webp",
        "category" : "all top accessories recomended",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "HKW Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/HKW.jpg",
        "category" : "all top accessories special",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "Lamina Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/lamina.jpg",
        "category" : "all hot accessories discount",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "Curved Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/curve.webp",
        "category" : "all hot accessories",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "Ceramic Glass",
        "gimmick" : "50.000,00 IDR",
        "price" : "45.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tempered Glass paling the best anti gores, tahan banting.",
        "gambar" : "productIMG/ceramic.jpg",
        "category" : "all accessories discount",
        "spesifikasi" :  [
            "Anti gores",
            "Tahan Banting",
            "Anti Air",
            "Anti debu",
            "Anti Spy",
            "Anti sinar ultraviolet"
        ]
    },
    {
        "nama" : "ECLE TWS",
        "gimmick" : "50.000,00 IDR",
        "price" : "167.900,00 IDR",
        "promo" : "10%",
        "deskripsi" : "TWS the best bisa jarak 5m wireless garansi 2 bulan pemakaian.",
        "gambar" : "productIMG/ecle.webp",
        "category" : "all hot accessories",
        "spesifikasi" :  [
            "Wireless",
            "Bluetooth 5.1",
            "One key control",
            "Memory Connection",
            "One key Control",
            "5m wirelss distance"
        ]
    },
    {
        "nama" : "Dacom TWS",
        "gimmick" : "50.000,00 IDR",
        "price" : "167.900,00 IDR",
        "promo" : "10%",
        "deskripsi" : "TWS the best bisa jarak 5m wireless garansi 2 bulan pemakaian.",
        "gambar" : "productIMG/dacom.jpg",
        "category" : "all accessories",
        "spesifikasi" :  [
            "Wireless",
            "Bluetooth 5.1",
            "One key control",
            "Memory Connection",
            "One key Control",
            "5m wirelss distance"
        ]
    },
    {
        "nama" : "Robot Earphone",
        "gimmick" : "50.000,00 IDR",
        "price" : "30.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tali anti putus, suara jelas dan tahan air.",
        "gambar" : "productIMG/robot.jpg",
        "category" : "all hot accessories",
        "spesifikasi" :  [
            "Sweat Proof",
            "Noise Isolation",
            "Twist Free Flexible Cable",
            "Garansi 3 bulan pemakaian",
            "Tahan Debu"
        ]
    },
    {
        "nama" : "MK160 Earphone",
        "gimmick" : "50.000,00 IDR",
        "price" : "50.000,00 IDR",
        "promo" : "10%",
        "deskripsi" : "Tali anti putus, suara jelas dan tahan air.",
        "gambar" : "productIMG/MK160.jpg",
        "category" : "all hot accessories",
        "spesifikasi" :  [
            "Sweat Proof",
            "Noise Isolation",
            "Twist Free Flexible Cable",
            "Garansi 3 bulan pemakaian",
            "Tahan Debu"
        ]
    }
]

// Function to update the counter in sessionStorage
function updateCounterMinus() {
    // Retrieve the current value of 'counter' from sessionStorage
    let counter = parseInt(sessionStorage.getItem('counter')) || 0;

    // Increment the counter
    counter--;

    // Update the sessionStorage with the new counter value
    sessionStorage.setItem('counter', counter);
}

function updateCounterPluss() {
    // Retrieve the current value of 'counter' from sessionStorage
    let counter = parseInt(sessionStorage.getItem('counter')) || 0;

    // Increment the counter
    counter++;

    // Update the sessionStorage with the new counter value
    sessionStorage.setItem('counter', counter);
}

let acc = 0
let canBuy = false
// Retrieve array on another page
const savedArray = JSON.parse(localStorage.getItem('myArray'))

let currentCounter = sessionStorage.getItem('counter')
const voucher = document.getElementById('accVoucher')
const hargaTotal = document.getElementById('total')
if (currentCounter === null) {
    voucher.innerHTML = `Voucher Obtained : x0`
} else {
    voucher.innerHTML = `Voucher Obtained : x${currentCounter}`
}

const emptyBox = document.querySelector('.empty-cart') 
if (!savedArray || savedArray.length === 0) {
    emptyBox.style.display ="block"
} else {
    canBuy = true
    emptyBox.style.display ="none"
    let parentLG = document.getElementById('lg')
    for (let i = 0; i < savedArray.length; i++) {
        let card = document.createElement('div')
        card.className = "card w-100 row content my-4"
        card.setAttribute("style", "height: 110px")
        let imgCart = document.createElement('div')
        imgCart.className = "cart-img col-2"
        let img = document.createElement('img')
        img.src = `${barang[savedArray[i]].gambar}`
        img.setAttribute("style", width="80%")
        imgCart.appendChild(img)
        let cartName = document.createElement('div')
        cartName.className = "cart-name col-4 mt-3"
        let productName = document.createElement('p')
        productName.textContent = `${barang[savedArray[i]].nama}`
        cartName.appendChild(productName)
        let cartPrice = document.createElement('div')
        cartPrice.className = "cart-price col-4 mt-3"
        let price = document.createElement('p')
        price.textContent = `Rp ${barang[savedArray[i]].price}`
        cartPrice.appendChild(price)
        let cartBtn = document.createElement('div')
        cartBtn.className = "cart-delete col-1 mt-3"
        let deleteBtn = document.createElement('button')
        deleteBtn.className = "btn btn-danger"
        deleteBtn.setAttribute('onclick', `deleteItem(${i})`)
        let trashicon = document.createElement('i')
        trashicon.className = "fa-solid fa-trash"
        deleteBtn.appendChild(trashicon)
        cartBtn.appendChild(deleteBtn)
        card.appendChild(imgCart)
        card.appendChild(cartName)
        card.appendChild(cartPrice)
        card.appendChild(cartBtn)
        card.id = `lg${i}`
        parentLG.appendChild(card)
        let str = barang[savedArray[i]].price
        let str1 = str.slice(0, str.length - 7)
        let str2 = str1.replace(/\./g, '')
        acc += Number(str2)
    }
    
    hargaTotal.innerHTML = `Total Price : ${acc} IDR`
    
    let parentMD = document.getElementById('md')
    for (let i = 0; i < savedArray.length; i++) {
        let card = document.createElement('div')
        card.className = "card w-100 row content h-auto my-4"
        let imgCart = document.createElement('div')
        imgCart.className = "cart-img col-12 mt-1 h-100"
        let img = document.createElement('img')
        img.src = `${barang[savedArray[i]].gambar}`
        imgCart.appendChild(img)
        let cartName = document.createElement('div')
        cartName.className = "cart-name col-12 mt-3"
        let productName = document.createElement('p')
        productName.textContent = `${barang[savedArray[i]].nama}`
        cartName.appendChild(productName)
        let cartPrice = document.createElement('div')
        cartPrice.className = "cart-price col-12 mt-3"
        let price = document.createElement('p')
        price.textContent = `Rp ${barang[savedArray[i]].price}`
        cartPrice.appendChild(price)
        let cartBtn = document.createElement('div')
        cartBtn.className = "cart-delete col-12 mt-3"
        let deleteBtn = document.createElement('button')
        deleteBtn.className = "btn btn-danger w-100"
        deleteBtn.setAttribute('onclick', `deleteItem(${i})`)
        let trashicon = document.createElement('i')
        trashicon.className = "fa-solid fa-trash"
        deleteBtn.appendChild(trashicon)
        cartBtn.appendChild(deleteBtn)
        card.appendChild(imgCart)
        card.appendChild(cartName)
        card.appendChild(cartPrice)
        card.appendChild(cartBtn)
        card.id = `md${i}`
        parentMD.appendChild(card)
    }
}

let voucherUsed = false
const useVoucher = document.getElementById('flexCheckDefault')
useVoucher.addEventListener('change', ()=> {
    if (useVoucher.checked && currentCounter != null && currentCounter > 0 && canBuy) {
        hargaTotal.innerHTML = `Total Price : <s style="color:red">${acc} IDR</s> ${acc * 0.9} IDR`
        voucher.innerHTML = `Voucher Obtained : x${currentCounter - 1}`
        voucherUsed = true
    } else {
        hargaTotal.innerHTML = `Total Price : ${acc} IDR`
        voucher.innerHTML = `Voucher Obtained : x${currentCounter}`
        voucherUsed = false
    }
})

const paymentPage = document.querySelector('.payment')
function checkout() {
    if (canBuy) {
        paymentPage.style.display = "block"
        document.querySelector('.blank-notif').style.display = "block"
    } else {
        document.querySelector('.cart-notif-beli').style.display = "block"
    
        setTimeout(()=> {
            location.reload();
            document.querySelector('.cart-notif-beli').style.display = "none"
        }, 1500)
    }
}

const confirmItem = document.querySelector('.payment-success')
function confirmPage() {
    paymentPage.style.display = "none"
    confirmItem.style.display = "block"
    localStorage.clear();
    if (voucherUsed) {
        updateCounterMinus()
    }
}

const notif = document.querySelector('.notif-redeem')


const redeemCode = document.getElementById('redeem-text')
function redeem() {
    console.log(redeemCode.value)
    if (redeemCode.value === "happylunarnewyear2025") {
        updateCounterPluss()
        notif.style.transition = '0.4s'
        notif.style.display = 'block'
        setTimeout(function() {
            notif.style.transition = '0.4s'
            notif.style.display = 'none'
            location.reload();
        },2350)
    }
}

function deleteItem(id) {
    let displayitemMD = document.getElementById(`md${id}`)
    let displayitemLG = document.getElementById(`lg${id}`)
    displayitemLG.style.display = 'none'
    displayitemMD.style.display = 'none'

        // Step 1: Retrieve the array from local storage
    let myArray = JSON.parse(localStorage.getItem('myArray')) || [];

    // Step 2: Specify the index to delete
    const indexToDelete = id; // Delete the second item (index starts at 0)

    // Step 3: Remove the item using splice
    if (indexToDelete >= 0 && indexToDelete < myArray.length) {
        myArray.splice(indexToDelete, 1); // Remove 1 item at the specified index
    }

    // Step 4: Save the updated array back to local storage
    localStorage.setItem('myArray', JSON.stringify(myArray));
    document.querySelector('.cart-notif').style.display = "block"
    
    setTimeout(()=> {
        location.reload();
        document.querySelector('.cart-notif').style.display = "none"
    }, 1500)
}